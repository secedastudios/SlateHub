# SlateHub Production Configuration
# Copy this file to .env.production and adjust values for your environment
# NEVER commit the actual .env.production file to version control!

# Environment
ENVIRONMENT=production

# ============================================
# Server Configuration
# ============================================
# Port 80 for HTTP (use reverse proxy for HTTPS)
SERVER_HOST=0.0.0.0
SERVER_PORT=80

# ============================================
# Database Configuration (SurrealDB)
# ============================================
DB_HOST=surrealdb
DB_PORT=8000
# CHANGE THESE! Use strong, unique passwords
DB_USERNAME=admin_CHANGE_ME
DB_PASSWORD=CHANGE_ME_USE_STRONG_PASSWORD
DB_NAMESPACE=slatehub
DB_NAME=production

# ============================================
# S3 Configuration
# ============================================
# For AWS S3 (recommended for production)
# S3_ENDPOINT=https://s3.amazonaws.com
# S3_REGION=us-west-2
# S3_ACCESS_KEY_ID=YOUR_AWS_ACCESS_KEY
# S3_SECRET_ACCESS_KEY=YOUR_AWS_SECRET_KEY
# S3_BUCKET=your-production-bucket

# For MinIO (self-hosted)
S3_ENDPOINT=http://minio:9000
S3_REGION=us-east-1
S3_ACCESS_KEY_ID=CHANGE_ME_PRODUCTION_KEY
S3_SECRET_ACCESS_KEY=CHANGE_ME_USE_STRONG_SECRET
S3_BUCKET=slatehub-production

# ============================================
# Security Configuration
# ============================================
# Generate these with: openssl rand -hex 32
JWT_SECRET=CHANGE_ME_GENERATE_SECURE_RANDOM_STRING
SESSION_SECRET=CHANGE_ME_GENERATE_SECURE_RANDOM_STRING

# Session settings
SESSION_SECURE=true
SESSION_DOMAIN=yourdomain.com
SESSION_MAX_AGE=86400  # 24 hours in seconds

# ============================================
# Logging Configuration
# ============================================
# Production should use structured logging
RUST_LOG=info,slatehub=info
LOG_FORMAT=json

# ============================================
# Rate Limiting
# ============================================
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW_SECS=60

# API rate limits (per endpoint)
RATE_LIMIT_API_REQUESTS=1000
RATE_LIMIT_API_WINDOW_SECS=3600

# ============================================
# Feature Flags
# ============================================
ENABLE_REGISTRATION=false
ENABLE_PUBLIC_PROJECTS=false
ENABLE_DEBUG_ENDPOINTS=false
ENABLE_METRICS=true

# ============================================
# File Upload Configuration
# ============================================
MAX_UPLOAD_SIZE_MB=100
ALLOWED_FILE_TYPES=png,jpg,jpeg,gif,webp,pdf,doc,docx,xls,xlsx,ppt,pptx,mp4,mov,avi
VIRUS_SCANNING_ENABLED=false  # Enable if you have ClamAV or similar

# ============================================
# Email Configuration (Production)
# ============================================
# SMTP Settings
SMTP_HOST=smtp.sendgrid.net
SMTP_PORT=587
SMTP_USERNAME=apikey
SMTP_PASSWORD=YOUR_SENDGRID_API_KEY
SMTP_FROM=noreply@yourdomain.com
SMTP_FROM_NAME=SlateHub

# Email verification
REQUIRE_EMAIL_VERIFICATION=true
EMAIL_VERIFICATION_TIMEOUT_HOURS=24

# ============================================
# External Services
# ============================================
# Analytics (optional)
# GOOGLE_ANALYTICS_ID=UA-XXXXXXXXX-X
# PLAUSIBLE_DOMAIN=yourdomain.com

# Error tracking (optional)
# SENTRY_DSN=https://xxx@xxx.ingest.sentry.io/xxx
# SENTRY_ENVIRONMENT=production

# ============================================
# Backup Configuration
# ============================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 3 * * *  # Daily at 3 AM
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=slatehub-backups

# ============================================
# Performance Tuning
# ============================================
# Database connection pool
DB_MAX_CONNECTIONS=100
DB_CONNECTION_TIMEOUT_SECS=5

# HTTP server
HTTP_KEEP_ALIVE_SECS=75
HTTP_REQUEST_TIMEOUT_SECS=30
HTTP_BODY_LIMIT_MB=50

# Worker threads (0 = number of CPU cores)
WORKER_THREADS=0

# ============================================
# Docker Configuration
# ============================================
# User ID for Docker containers
UID=1001

# Resource limits are defined in docker-compose.prod.yml
# Adjust them based on your server capacity

# ============================================
# Monitoring & Health Checks
# ============================================
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL_SECS=30
METRICS_ENDPOINT=/metrics
METRICS_AUTH_TOKEN=CHANGE_ME_SECURE_TOKEN

# ============================================
# CORS Configuration
# ============================================
CORS_ALLOWED_ORIGINS=https://yourdomain.com,https://www.yourdomain.com
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Requested-With
CORS_MAX_AGE_SECS=86400

# ============================================
# CDN Configuration (optional)
# ============================================
# CDN_ENABLED=true
# CDN_URL=https://cdn.yourdomain.com
# CDN_PULL_ZONE=your-pull-zone

# ============================================
# Legal & Compliance
# ============================================
GDPR_ENABLED=true
COOKIE_CONSENT_REQUIRED=true
PRIVACY_POLICY_URL=https://yourdomain.com/privacy
TERMS_OF_SERVICE_URL=https://yourdomain.com/terms

# ============================================
# Maintenance Mode
# ============================================
MAINTENANCE_MODE=false
MAINTENANCE_MESSAGE=We are currently performing scheduled maintenance. We'll be back soon!
MAINTENANCE_ALLOWED_IPS=127.0.0.1,::1  # Admin IPs that can bypass maintenance

# ============================================
# Notes
# ============================================
# 1. Generate secure secrets with: openssl rand -hex 32
# 2. Use a password manager to store production credentials
# 3. Set up monitoring and alerting for production
# 4. Configure automated backups
# 5. Use HTTPS in production (via reverse proxy)
# 6. Review and adjust rate limits based on usage
# 7. Enable only necessary features
# 8. Monitor logs regularly for security issues
