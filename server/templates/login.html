<!doctype html>
<html lang="en" data-theme="dark">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="color-scheme" content="light dark" />
        <meta
            name="description"
            content="Login to SlateHub - Your gateway to the entertainment industry"
        />
        <title>{{ app_name }} - Login</title>

        <!-- Pico CSS -->
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css"
        />

        <!-- SlateHub Custom Overrides -->
        <link rel="stylesheet" href="/static/css/slatehub-pico.css" />
        <link rel="stylesheet" href="/static/css/layout.css" />
        <link rel="stylesheet" href="/static/css/forms.css" />

        <!-- Modern Theme -->
        <link rel="stylesheet" href="/static/css/modern-theme.css" />
        <link rel="stylesheet" href="/static/css/modern-enhancements.css" />
        <link rel="stylesheet" href="/static/css/forms-modern.css" />

        <!-- Theme Initialization Script -->
        <script>
            const savedTheme = localStorage.getItem("theme") || "dark";
            document.documentElement.setAttribute("data-theme", savedTheme);
        </script>
    </head>
    <body data-page="login" data-user="anonymous">
        <header id="site-header">
            <nav id="main-nav" aria-label="Main navigation">
                <ul data-role="nav-brand">
                    <li>
                        <a href="/" id="site-logo"
                            ><strong>{{ app_name }}</strong></a
                        >
                    </li>
                </ul>
                <ul data-role="nav-primary">
                    <li><a href="/">Home</a></li>
                    <li><a href="/projects">Projects</a></li>
                    <li><a href="/people">People</a></li>
                    <li><a href="/about">About</a></li>
                </ul>
                <ul data-role="nav-user">
                    <li data-component="theme-toggle">
                        <button
                            id="theme-toggle"
                            type="button"
                            aria-label="Toggle theme"
                            data-tooltip="Toggle theme"
                            data-placement="bottom"
                        >
                            <span data-theme-icon="light" aria-hidden="true"
                                >‚òÄÔ∏è</span
                            >
                            <span data-theme-icon="dark" aria-hidden="true"
                                >üåô</span
                            >
                        </button>
                    </li>
                    {% match user %} {% when Some with (user) %}
                    <li data-component="user-menu">
                        <details id="user-menu">
                            <summary role="button">
                                <img
                                    src="{{ user.avatar }}"
                                    alt="{{ user.name }}"
                                    data-role="avatar"
                                />
                            </summary>
                            <ul data-role="dropdown-menu">
                                <li><a href="/profile">Profile</a></li>
                                <li><a href="/settings">Settings</a></li>
                                <li><hr /></li>
                                <li>
                                    <form
                                        id="form-logout"
                                        action="/logout"
                                        method="post"
                                    >
                                        <button type="submit">Logout</button>
                                    </form>
                                </li>
                            </ul>
                        </details>
                    </li>
                    {% when None %}
                    <li>
                        <a href="/login" role="button" aria-current="page"
                            >Login</a
                        >
                    </li>
                    <li><a href="/signup" role="button">Sign Up</a></li>
                    {% endmatch %}
                </ul>
            </nav>
        </header>

        <main id="main-content">
            <section data-component="auth-form" data-type="login">
                <header data-role="form-header">
                    <hgroup>
                        <h1 id="heading-login">Welcome Back</h1>
                        <p>Log in to your SlateHub account</p>
                    </hgroup>
                </header>

                {% match error %} {% when Some with (err) %}
                <div
                    id="error-login"
                    role="alert"
                    aria-live="polite"
                    data-role="error-message"
                >
                    {{ err }}
                </div>
                {% when None %} {% endmatch %}

                <form
                    id="form-login"
                    data-component="form"
                    method="post"
                    action="/login"
                >
                    {% match redirect_to %} {% when Some with (redirect) %}
                    <input
                        type="hidden"
                        name="redirect_to"
                        value="{{ redirect }}"
                    />
                    {% when None %} {% endmatch %}

                    <fieldset data-role="form-section">
                        <div data-field="email">
                            <label for="input-email">Email or Username</label>
                            <input
                                type="text"
                                id="input-email"
                                name="email"
                                placeholder="Enter your email or username"
                                required
                                autofocus
                                aria-required="true"
                                {%
                                match
                                error
                                %}
                                {%
                                when
                                Some
                                with
                                (_)
                                %}
                                aria-invalid="true"
                                aria-describedby="error-login"
                                {%
                                when
                                None
                                %}
                                aria-invalid="false"
                                {%
                                endmatch
                                %}
                            />
                        </div>

                        <div data-field="password">
                            <label for="input-password">Password</label>
                            <input
                                type="password"
                                id="input-password"
                                name="password"
                                placeholder="Enter your password"
                                required
                                aria-required="true"
                                {%
                                match
                                error
                                %}
                                {%
                                when
                                Some
                                with
                                (_)
                                %}
                                aria-invalid="true"
                                aria-describedby="error-login"
                                {%
                                when
                                None
                                %}
                                aria-invalid="false"
                                {%
                                endmatch
                                %}
                            />
                        </div>

                        <div data-field="remember">
                            <label for="input-remember">
                                <input
                                    type="checkbox"
                                    id="input-remember"
                                    name="remember"
                                    role="switch"
                                />
                                Remember me
                            </label>
                        </div>
                    </fieldset>

                    <div data-role="form-actions">
                        <button type="submit" data-type="primary">
                            Log In
                        </button>
                    </div>

                    <nav
                        id="nav-login-alternatives"
                        aria-label="Login alternatives"
                        data-role="form-footer"
                    >
                        <ul>
                            <li>
                                <a href="/forgot-password"
                                    >Forgot your password?</a
                                >
                            </li>
                            <li>
                                <span
                                    >Don't have an account?
                                    <a href="/signup">Sign up</a></span
                                >
                            </li>
                        </ul>
                    </nav>
                </form>
            </section>
        </main>

        <footer id="site-footer">
            <section data-role="footer-main">
                <div data-role="footer-brand">
                    <hgroup>
                        <h3 id="footer-brand-title">{{ app_name }}</h3>
                        <p>
                            A free, open-source SaaS platform for the TV, film,
                            and content industries.
                        </p>
                    </hgroup>
                </div>

                <div data-role="footer-links">
                    <h4 id="footer-links-title">Quick Links</h4>
                    <nav aria-labelledby="footer-links-title">
                        <ul>
                            <li><a href="/docs">Documentation</a></li>
                            <li><a href="/api">API</a></li>
                            <li><a href="/privacy">Privacy Policy</a></li>
                            <li><a href="/terms">Terms of Service</a></li>
                        </ul>
                    </nav>
                </div>

                <div data-role="footer-connect">
                    <h4 id="footer-connect-title">Connect</h4>
                    <nav aria-labelledby="footer-connect-title">
                        <ul>
                            <li>
                                <a
                                    href="https://github.com/slatehub"
                                    rel="noopener noreferrer"
                                    target="_blank"
                                    >GitHub</a
                                >
                            </li>
                            <li><a href="/contact">Contact</a></li>
                            <li><a href="/blog">Blog</a></li>
                        </ul>
                    </nav>
                </div>
            </section>

            <hr />

            <section data-role="footer-copyright">
                <p>
                    <small
                        >¬© {{ year }} {{ app_name }}. All rights
                        reserved.</small
                    >
                </p>
                <p><small data-role="version">v{{ version }}</small></p>
            </section>
        </footer>

        <!-- Theme Toggle Logic -->
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                const themeToggle = document.getElementById("theme-toggle");
                if (themeToggle) {
                    themeToggle.addEventListener("click", function () {
                        const currentTheme =
                            document.documentElement.getAttribute("data-theme");
                        const newTheme =
                            currentTheme === "light" ? "dark" : "light";
                        document.documentElement.setAttribute(
                            "data-theme",
                            newTheme,
                        );
                        localStorage.setItem("theme", newTheme);
                    });
                }
            });
        </script>
    </body>
</html>
