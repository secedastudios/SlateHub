{% extends "_layout.html" %}
{% block title %}
    Reset Password -
    {{ app_name }}
{% endblock %}
{% block page_name %}
    reset-password
{% endblock %}
{% block content %}
    <section id="section-reset-password" data-component="auth-form" data-type="password-reset">
        <header id="reset-password-header" data-role="form-header">
            <hgroup>
                <h1 id="heading-reset-password">Create New Password</h1>
                <p data-role="subtitle">
                    Enter your reset code and choose a new password
                </p>
            </hgroup>
        </header>
        {% match error %}
            {% when Some with (err) %}
            <div
                id="alert-reset-error"
                role="alert"
                aria-live="polite"
                data-component="alert"
                data-type="error"
            >{{ err }}</div>
            {% when None %}
        {% endmatch %}
        {% match success %}
            {% when Some with (msg) %}
            <div
                id="alert-reset-success"
                role="alert"
                aria-live="polite"
                data-component="alert"
                data-type="success"
            >{{ msg }}</div>
            {% when None %}
        {% endmatch %}
        <form
            id="form-reset-password"
            method="post"
            action="/reset-password"
            data-component="form"
            data-state="ready"
        >
            <fieldset id="fieldset-reset-credentials" data-role="form-section">
                <legend hidden>Reset Password Credentials</legend>
                <div id="field-email" data-field="email">
                    <label for="input-email">Email Address</label>
                    <input
                        type="email"
                        id="input-email"
                        name="email"
                        placeholder="Enter your email address"
                        value="{% match email %}{% when Some with (e) %}{{ e }}{% when None %}{% endmatch %}"
                        required
                        aria-required="true"
                        aria-describedby="help-email"
                    />
                    <small id="help-email" data-role="help-text">
                        The email address associated with your account
                    </small>
                </div>
                <div id="field-reset-code" data-field="code">
                    <label for="input-code">Reset Code</label>
                    <input
                        type="text"
                        id="input-code"
                        name="code"
                        placeholder="Enter 6-digit code"
                        value="{% match code %}{% when Some with (c) %}{{ c }}{% when None %}{% endmatch %}"
                        maxlength="6"
                        pattern="[0-9]{6}"
                        required
                        aria-required="true"
                        aria-describedby="help-code"
                    />
                    <small id="help-code" data-role="help-text">
                        The 6-digit code from your password reset email
                    </small>
                </div>
            </fieldset>
            <fieldset id="fieldset-new-password" data-role="form-section">
                <legend>New Password</legend>
                <div id="field-password" data-field="password">
                    <label for="input-password">New Password</label>
                    <input
                        type="password"
                        id="input-password"
                        name="password"
                        placeholder="Enter new password"
                        minlength="8"
                        required
                        aria-required="true"
                        aria-describedby="help-password"
                    />
                    <small id="help-password" data-role="help-text">Must be at least 8 characters long</small>
                </div>
                <div id="field-password-confirm" data-field="password_confirm">
                    <label for="input-password-confirm">Confirm New Password</label>
                    <input
                        type="password"
                        id="input-password-confirm"
                        name="password_confirm"
                        placeholder="Re-enter new password"
                        minlength="8"
                        required
                        aria-required="true"
                        aria-describedby="help-password-confirm"
                    />
                    <small id="help-password-confirm" data-role="help-text">
                        Enter the same password again to confirm
                    </small>
                </div>
            </fieldset>
            <div id="form-actions" data-role="form-actions">
                <button
                    type="submit"
                    id="button-reset-password"
                    data-type="primary"
                >Reset Password</button>
            </div>
        </form>
        <nav id="nav-reset-links" data-role="auth-links" aria-label="Password reset navigation">
            <p data-role="link-group">
                <span>Remember your password?</span>
                <a href="/login" id="link-login">Back to login</a>
            </p>
            <p data-role="link-group">
                <span>Need a new reset code?</span>
                <a href="/forgot-password" id="link-forgot">Request new code</a>
            </p>
        </nav>
    </section>
{% endblock %}
