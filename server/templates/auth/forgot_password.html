{% extends "_layout.html" %}
{% block title %}
    Forgot Password -
    {{ app_name }}
{% endblock %}
{% block page_name %}
    forgot-password
{% endblock %}
{% block content %}
    <section id="section-forgot-password" data-component="auth-form" data-type="password-reset">
        <header id="forgot-password-header" data-role="form-header">
            <hgroup>
                <h1 id="heading-forgot-password">Reset Your Password</h1>
                <p data-role="subtitle">
                    Enter your email address and we'll send you a password reset code
                </p>
            </hgroup>
        </header>
        {% match error %}
            {% when Some with (err) %}
            <div
                id="alert-reset-error"
                role="alert"
                aria-live="polite"
                data-component="alert"
                data-type="error"
            >{{ err }}</div>
            {% when None %}
        {% endmatch %}
        {% match success %}
            {% when Some with (msg) %}
            <div id="reset-code-sent" data-component="success-panel" data-state="active">
                <div
                    id="alert-reset-success"
                    role="alert"
                    aria-live="polite"
                    data-component="alert"
                    data-type="success"
                >
                    <p data-role="alert-message">{{ msg }}</p>
                </div>
                <div id="reset-instructions" data-role="instructions">
                    <h2 id="heading-instructions">Next Steps</h2>
                    <ol id="list-instructions" data-role="steps">
                        <li>
                            Check your email for the 6-digit reset code
                        </li>
                        <li>
                            Click the button below to enter your code
                        </li>
                        <li>Create your new password</li>
                    </ol>
                </div>
                <nav id="nav-reset-actions" data-role="action-panel">
                    <a
                        href="/reset-password{% match email %}{% when Some with (e) %}?email={{ e }}{% when None %}{% endmatch %}"
                        id="link-enter-code"
                        role="button"
                        data-type="primary"
                    >Enter Reset Code</a>
                    <p data-role="alternative-action">
                        <span>Didn't receive the email?</span>
                        <a href="/forgot-password" id="link-try-again">Try again</a>
                    </p>
                </nav>
            </div>
            {% when None %}
            <form
                id="form-forgot-password"
                method="post"
                action="/forgot-password"
                data-component="form"
                data-state="ready"
            >
                <fieldset id="fieldset-reset-request" data-role="form-section">
                    <legend hidden>Password Reset Request</legend>
                    <div id="field-email" data-field="email">
                        <label for="input-email">Email Address</label>
                        <input
                            type="email"
                            id="input-email"
                            name="email"
                            placeholder="Enter your account email"
                            required
                            autofocus
                            aria-required="true"
                            aria-describedby="help-email"
                        />
                        <small id="help-email" data-role="help-text">
                            We'll send a password reset code to this email address
                        </small>
                    </div>
                </fieldset>
                <div id="form-actions" data-role="form-actions">
                    <button
                        type="submit"
                        id="button-send-reset"
                        data-type="primary"
                    >Send Reset Code</button>
                </div>
            </form>
            <nav id="nav-reset-links" data-role="auth-links" aria-label="Password reset navigation">
                <p data-role="link-group">
                    <span>Remember your password?</span>
                    <a href="/login" id="link-login">Back to login</a>
                </p>
                <p data-role="link-group">
                    <span>Don't have an account?</span>
                    <a href="/signup" id="link-signup">Sign up</a>
                </p>
            </nav>
        {% endmatch %}
    </section>
{% endblock %}
