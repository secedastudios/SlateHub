{% extends "_layout.html" %} {% block title %}People - {{ app_name }}{% endblock
%} {% block page_name %}people{% endblock %} {% block content %}
<section id="people-main" data-component="people-page">
    <header id="people-header" data-role="page-header">
        <h1 id="heading-people">People</h1>
        <p>Connect with talented professionals in the film industry</p>
    </header>

    <section id="section-controls" data-section="controls">
        <div data-component="search-bar">
            <form id="form-search-people" method="get" action="/people">
                <div data-field="search">
                    <label for="input-search" hidden>Search people</label>
                    <input
                        type="search"
                        id="input-search"
                        name="filter"
                        placeholder="Search by name, skill, or location..."
                        value="{% if filter.is_some() %}{{ filter.as_ref().unwrap() }}{% endif %}"
                        aria-label="Search people"
                    />
                    <button type="submit" data-type="primary">
                        <span>Search</span>
                    </button>
                </div>
            </form>
        </div>

        {% if !specialties.is_empty() %}
        <div id="specialty-filters" data-component="filter-tags">
            <label id="label-specialties">Filter by specialty:</label>
            <div data-role="tag-list" aria-labelledby="label-specialties">
                {% for specialty in specialties %}
                <button
                    type="button"
                    data-role="filter-tag"
                    data-filter="{{ specialty }}"
                    onclick="filterBySpecialty('{{ specialty }}')"
                >
                    {{ specialty }}
                </button>
                {% endfor %}
            </div>
        </div>
        {% endif %}
    </section>

    <section
        id="section-people-list"
        data-section="people-list"
        data-layout="grid"
        data-state="{% if people.is_empty() %}empty{% else %}ready{% endif %}"
    >
        {% if !people.is_empty() %}
        <div data-role="content-container">
            {% for person in people %}
            <article
                data-component="person-card"
                data-person-id="{{ person.id }}"
                data-username="{{ person.username }}"
            >
                <header data-role="card-header">
                    <img
                        src="{{ person.avatar }}"
                        alt="{{ person.name }}"
                        data-role="avatar"
                        width="80"
                        height="80"
                    />
                    <div data-role="person-info">
                        <h2 id="person-name-{{ person.id }}">
                            <a href="/profile/{{ person.username }}">
                                {{ person.name }}
                            </a>
                        </h2>
                        {% if person.headline.is_some() %}
                        <p data-role="headline">
                            {{ person.headline.as_ref().unwrap() }}
                        </p>
                        {% endif %} {% if person.location.is_some() %}
                        <p data-role="location">
                            <span aria-hidden="true">üìç</span>
                            <span>{{ person.location.as_ref().unwrap() }}</span>
                        </p>
                        {% endif %}
                    </div>
                </header>

                <div data-role="card-body">
                    {% if person.bio.is_some() %}
                    <div data-role="bio">
                        <p>{{ person.bio.as_ref().unwrap() }}</p>
                    </div>
                    {% endif %} {% if !person.skills.is_empty() %}
                    <div data-role="skills-list">
                        {% for skill in person.skills %}
                        <span data-role="skill-tag" data-skill="{{ skill }}">
                            {{ skill }}
                        </span>
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>

                <footer data-role="card-footer">
                    <nav data-role="card-actions">
                        <a
                            href="/profile/{{ person.username }}"
                            role="button"
                            data-type="primary"
                        >
                            View Profile
                        </a>
                        <button
                            type="button"
                            data-type="secondary"
                            data-action="message"
                            data-person-id="{{ person.id }}"
                            onclick="sendMessage('{{ person.id }}')"
                        >
                            Message
                        </button>
                    </nav>
                </footer>
            </article>
            {% endfor %}
        </div>
        {% else %}
        <div id="empty-state-people" data-role="empty-state">
            <h2 id="heading-empty">No people found</h2>
            {% if filter.is_some() %}
            <p>
                No people match your search criteria. Try adjusting your
                filters.
            </p>
            {% else %}
            <p>Be the first to join our community!</p>
            {% endif %}
            <nav data-role="empty-state-actions">
                <a href="/signup" role="button" data-type="primary">
                    Join Now
                </a>
            </nav>
        </div>
        {% endif %}
    </section>
</section>

<script>
    function filterBySpecialty(specialty) {
        const url = new URL(window.location);
        url.searchParams.set("filter", specialty);
        window.location.href = url.toString();
    }

    function sendMessage(personId) {
        // This would typically open a message dialog or redirect to a messaging page
        alert("Messaging feature coming soon!");
    }
</script>
{% endblock %}
