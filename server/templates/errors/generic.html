{% extends "_layout.html" %} {% block title %}Error {{ status_code }} - {{
app_name }}{% endblock %} {% block description %}An error occurred while
processing your request.{% endblock %} {% block page_name %}error-generic{%
endblock %} {% block content %}
<article
    id="error-generic-main"
    data-component="error-page"
    data-error-code="{{ status_code }}"
    data-error-type="generic"
>
    <header id="error-header" data-role="error-header">
        <h1 id="heading-error-code">{{ status_code }}</h1>
        <h2 id="heading-error-title">
            {% if status_text %} {{ status_text }} {% elif status_code == 400 %}
            Bad Request {% elif status_code == 402 %} Payment Required {% elif
            status_code == 405 %} Method Not Allowed {% elif status_code == 408
            %} Request Timeout {% elif status_code == 409 %} Conflict {% elif
            status_code == 410 %} Gone {% elif status_code == 413 %} Payload Too
            Large {% elif status_code == 414 %} URI Too Long {% elif status_code
            == 415 %} Unsupported Media Type {% elif status_code == 422 %}
            Unprocessable Entity {% elif status_code == 429 %} Too Many Requests
            {% elif status_code == 502 %} Bad Gateway {% elif status_code == 503
            %} Service Unavailable {% elif status_code == 504 %} Gateway Timeout
            {% else %} An Error Occurred {% endif %}
        </h2>
    </header>

    <section id="section-error-details" data-section="error-details">
        <p id="error-description" data-role="error-description">
            {% if message %} {{ message }} {% elif status_code == 400 %} The
            request could not be understood or was missing required parameters.
            {% elif status_code == 402 %} This feature requires payment or an
            active subscription. {% elif status_code == 405 %} The requested
            method is not allowed for this resource. {% elif status_code == 408
            %} The request took too long to process. Please try again. {% elif
            status_code == 409 %} The request could not be completed due to a
            conflict with the current state of the resource. {% elif status_code
            == 410 %} The requested resource is no longer available and has been
            permanently removed. {% elif status_code == 413 %} The request is
            larger than the server is willing or able to process. {% elif
            status_code == 414 %} The requested URL is too long for the server
            to process. {% elif status_code == 415 %} The request entity has a
            media type which the server does not support. {% elif status_code ==
            422 %} The request was well-formed but contains validation errors.
            {% elif status_code == 429 %} You've made too many requests. Please
            wait before trying again. {% elif status_code == 502 %} The server
            received an invalid response from an upstream server. {% elif
            status_code == 503 %} The service is temporarily unavailable. Please
            try again later. {% elif status_code == 504 %} The server did not
            receive a timely response from an upstream server. {% else %} An
            unexpected error occurred while processing your request. {% endif %}
        </p>

        <dl id="error-metadata" data-role="error-metadata">
            {% if request_path %}
            <dt id="label-request-path">Requested path</dt>
            <dd id="detail-request-path" data-field="request-path">
                <code>{{ request_path }}</code>
            </dd>
            {% endif %} {% if request_id %}
            <dt id="label-request-id">Request ID</dt>
            <dd id="detail-request-id" data-field="request-id">
                <code>{{ request_id }}</code>
            </dd>
            {% endif %} {% if timestamp %}
            <dt id="label-timestamp">Timestamp</dt>
            <dd id="detail-timestamp" data-field="timestamp">
                <time datetime="{{ timestamp }}">{{ timestamp }}</time>
            </dd>
            {% endif %}
        </dl>

        {% if details %}
        <details id="error-additional-details" data-component="collapsible">
            <summary id="button-show-details" role="button">
                Additional Details
            </summary>
            <div id="details-content" data-role="details-content">
                <pre id="error-details-text"><code>{{ details }}</code></pre>
            </div>
        </details>
        {% endif %}

        <nav
            id="error-actions"
            data-role="error-actions"
            aria-label="Error recovery actions"
        >
            {% if status_code == 429 %}
            <button
                id="button-retry"
                onclick="setTimeout(() => window.location.reload(), 3000)"
                data-type="primary"
                aria-label="Retry request in 3 seconds"
            >
                <span aria-hidden="true" data-role="icon">‚è±Ô∏è</span>
                <span data-role="button-text">Retry in 3 seconds...</span>
            </button>
            {% elif status_code >= 500 %}
            <button
                id="button-reload"
                onclick="window.location.reload()"
                data-type="primary"
                aria-label="Reload the page"
            >
                <span aria-hidden="true" data-role="icon">üîÑ</span>
                <span data-role="button-text">Try Again</span>
            </button>
            {% else %}
            <button
                id="button-back"
                onclick="window.history.back()"
                data-type="primary"
                aria-label="Go back to previous page"
            >
                <span aria-hidden="true" data-role="icon">‚¨ÖÔ∏è</span>
                <span data-role="button-text">Go Back</span>
            </button>
            {% endif %}

            <a
                href="/"
                id="link-error-home"
                role="button"
                data-type="secondary"
                aria-label="Go to homepage"
            >
                <span aria-hidden="true" data-role="icon">üè†</span>
                <span data-role="button-text">Go to Homepage</span>
            </a>

            {% if user.is_some() %}
            <a
                href="/projects"
                id="link-error-projects"
                role="button"
                data-type="secondary"
                aria-label="View your projects"
            >
                <span aria-hidden="true" data-role="icon">üìÅ</span>
                <span data-role="button-text">View Your Projects</span>
            </a>
            {% else %}
            <a
                href="/login"
                id="link-error-login"
                role="button"
                data-type="secondary"
                aria-label="Sign in to your account"
            >
                <span aria-hidden="true" data-role="icon">üîë</span>
                <span data-role="button-text">Sign In</span>
            </a>
            {% endif %}
        </nav>

        {% if status_code == 422 and validation_errors %}
        <section
            id="section-validation-errors"
            data-section="validation-errors"
            aria-labelledby="heading-validation-errors"
        >
            <h3 id="heading-validation-errors">Validation Errors</h3>
            <ul id="validation-errors-list" data-role="error-list" role="list">
                {% for error in validation_errors %}
                <li
                    id="validation-error-{{ loop.index }}"
                    data-field="{% if error.field %}{{ error.field }}{% endif %}"
                    data-role="error-item"
                >
                    {% if error.field %}
                    <strong data-role="field-name">{{ error.field }}:</strong>
                    {% endif %}
                    <span data-role="error-message">{{ error.message }}</span>
                </li>
                {% endfor %}
            </ul>
        </section>
        {% endif %} {% if retry_after %}
        <div id="retry-info" data-role="retry-info">
            <p id="retry-message" data-role="retry-message">
                Please wait
                <strong id="retry-duration">{{ retry_after }}</strong> seconds
                before retrying.
            </p>
        </div>
        {% endif %}
    </section>

    <footer id="error-footer" data-role="error-footer">
        <div id="error-help" data-role="help-section">
            {% if status_code >= 500 %}
            <p id="help-apology" data-role="help-text">
                We apologize for the inconvenience. Our team has been notified
                and is working to resolve the issue.
            </p>
            {% endif %}
            <p id="help-contact" data-role="help-text">
                If you continue to experience problems, please
                <a href="/contact" id="link-contact-support">contact support</a>
                {% if request_id %}with request ID
                <code>{{ request_id }}</code>{% endif %}.
            </p>
        </div>
    </footer>
</article>

<script>
    // Auto-reload for rate limiting
    {% if status_code == 429 and retry_after %}
    setTimeout(() => {
        window.location.reload();
    }, {{ retry_after * 1000 }});
    {% endif %}
</script>
{% endblock %}
