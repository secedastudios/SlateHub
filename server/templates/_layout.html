<!doctype html>
<html lang="en" data-theme="dark">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="color-scheme" content="light dark" />
        <meta
            name="description"
            content="{% block description %}SlateHub - A collaborative hub for the TV, film, and content industries{% endblock %}"
        />
        <title>{% block title %}{{ app_name }}{% endblock %}</title>

        <!-- Pico CSS -->
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css"
        />

        <!-- SlateHub Custom Overrides -->
        <link rel="stylesheet" href="/static/css/slatehub-pico.css" />
        <link rel="stylesheet" href="/static/css/layout.css" />
        <link rel="stylesheet" href="/static/css/forms.css" />
        <link rel="stylesheet" href="/static/css/profile.css" />

        <!-- Theme Initialization Script -->
        <script>
            // Check for saved theme preference or default to dark
            const savedTheme = localStorage.getItem("theme") || "dark";
            document.documentElement.setAttribute("data-theme", savedTheme);
        </script>

        {% block head %}{% endblock %}
    </head>
    <body
        data-page="{% block page_name %}default{% endblock %}"
        data-user="{% if user.is_some() %}authenticated{% else %}anonymous{% endif %}"
    >
        <header id="site-header">
            <nav id="main-nav" aria-label="Main navigation">
                <ul data-role="nav-brand">
                    <li>
                        <a href="/" id="site-logo">
                            <strong>{{ app_name }}</strong>
                        </a>
                    </li>
                </ul>
                <ul data-role="nav-primary">
                    <li>
                        <a href="/" {% if active_page == "home" %}aria-current="page"{% endif %}>Home</a>
                    </li>
                    <li>
                        <a href="/projects" {% if active_page == "projects" %}aria-current="page"{% endif %}>Projects</a>
                    </li>
                    <li>
                        <a href="/people" {% if active_page == "people" %}aria-current="page"{% endif %}>People</a>
                    </li>
                    <li>
                        <a href="/about" {% if active_page == "about" %}aria-current="page"{% endif %}>About</a>
                    </li>
                </ul>
                <ul data-role="nav-user">
                    <li data-component="theme-toggle">
                        <!-- Theme Toggle -->
                        <button
                            id="theme-toggle"
                            type="button"
                            aria-label="Toggle theme"
                            data-tooltip="Toggle theme"
                            data-placement="bottom"
                        >
                            <span data-theme-icon="light" aria-hidden="true">‚òÄÔ∏è</span>
                            <span data-theme-icon="dark" aria-hidden="true">üåô</span>
                        </button>
                    </li>
                    {% match user %}
                    {% when Some with (user) %}
                    <li data-component="user-menu">
                        <details id="user-menu">
                            <summary role="button" aria-label="User menu">
                                <img
                                    src="{{ user.avatar }}"
                                    alt="{{ user.name }}"
                                    data-role="avatar"
                                />
                            </summary>
                            <ul data-role="dropdown-menu" dir="rtl">
                                <li><a href="/profile">Profile</a></li>
                                <li><a href="/settings">Settings</a></li>
                                <li><hr /></li>
                                <li>
                                    <form
                                        id="form-logout"
                                        action="/logout"
                                        method="post"
                                    >
                                        <button type="submit">Logout</button>
                                    </form>
                                </li>
                            </ul>
                        </details>
                    </li>
                    {% when None %}
                    <li>
                        <a href="/login" role="button" data-type="primary">Login</a>
                    </li>
                    <li>
                        <a href="/signup" role="button" data-type="secondary">Sign Up</a>
                    </li>
                    {% endmatch %}
                </ul>
            </nav>
        </header>

        <main id="main-content">{% block content %}{% endblock %}</main>

        <footer id="site-footer">
            <section data-role="footer-main">
                <div data-role="footer-brand">
                    <hgroup>
                        <h3 id="footer-brand-title">{{ app_name }}</h3>
                        <p>
                            A free, open-source SaaS platform for the TV, film,
                            and content industries.
                        </p>
                    </hgroup>
                </div>

                <div data-role="footer-links">
                    <h4 id="footer-links-title">Quick Links</h4>
                    <nav aria-labelledby="footer-links-title">
                        <ul>
                            <li><a href="/docs">Documentation</a></li>
                            <li><a href="/api">API</a></li>
                            <li><a href="/privacy">Privacy Policy</a></li>
                            <li><a href="/terms">Terms of Service</a></li>
                        </ul>
                    </nav>
                </div>

                <div data-role="footer-connect">
                    <h4 id="footer-connect-title">Connect</h4>
                    <nav aria-labelledby="footer-connect-title">
                        <ul>
                            <li>
                                <a
                                    href="https://github.com/slatehub"
                                    rel="noopener noreferrer"
                                    target="_blank"
                                >GitHub</a>
                            </li>
                            <li><a href="/contact">Contact</a></li>
                            <li><a href="/blog">Blog</a></li>
                        </ul>
                    </nav>
                </div>
            </section>

            <hr />

            <section data-role="footer-copyright">
                <p>
                    <small>¬© {{ year }} {{ app_name }}. All rights reserved.</small>
                </p>
                <p>
                    <small data-role="version">v{{ version }}</small>
                </p>
            </section>
        </footer>

        <!-- Theme Toggle Logic -->
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                const themeToggle = document.getElementById("theme-toggle");
                if (themeToggle) {
                    themeToggle.addEventListener("click", function () {
                        const currentTheme =
                            document.documentElement.getAttribute("data-theme");
                        const newTheme =
                            currentTheme === "light" ? "dark" : "light";
                        document.documentElement.setAttribute(
                            "data-theme",
                            newTheme,
                        );
                        localStorage.setItem("theme", newTheme);
                    });
                }
            });
        </script>

        {% block scripts %}{% endblock %}
    </body>
</html>
